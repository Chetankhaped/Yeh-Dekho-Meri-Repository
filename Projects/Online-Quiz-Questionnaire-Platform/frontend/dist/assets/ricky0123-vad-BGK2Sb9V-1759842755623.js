import{r as Ht}from"./onnxruntime-web-BS86J_hp-1759842755623.js";var Pt={exports:{}};/*! For license information please see index.js.LICENSE.txt */(function(_t,Jt){(function(mt,ot){_t.exports=ot(Ht())})(self,mt=>(()=>{var ot={656:F=>{F.exports=mt}},gt={};function M(F){var G=gt[F];if(G!==void 0)return G.exports;var B=gt[F]={exports:{}};return ot[F](B,B.exports,M),B.exports}M.d=(F,G)=>{for(var B in G)M.o(G,B)&&!M.o(F,B)&&Object.defineProperty(F,B,{enumerable:!0,get:G[B]})},M.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),M.o=(F,G)=>Object.prototype.hasOwnProperty.call(F,G),M.r=F=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})},(()=>{var F;M.g.importScripts&&(F=M.g.location+"");var G=M.g.document;if(!F&&G&&(G.currentScript&&(F=G.currentScript.src),!F)){var B=G.getElementsByTagName("script");B.length&&(F=B[B.length-1].src)}if(!F)throw new Error("Automatic publicPath is not supported in this browser");F=F.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),M.p=F})();var it={};return(()=>{function F(n){return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},F(n)}function G(){G=function(){return n};var n={},u=Object.prototype,a=u.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},i=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function f(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(t,o,s){return t[o]=s}}function p(e,t,o,s){var r=t&&t.prototype instanceof k?t:k,y=Object.create(r.prototype),m=new I(s||[]);return y._invoke=function(S,P,l){var b="suspendedStart";return function(E,W){if(b==="executing")throw new Error("Generator is already running");if(b==="completed"){if(E==="throw")throw W;return{value:void 0,done:!0}}for(l.method=E,l.arg=W;;){var q=l.delegate;if(q){var U=D(q,l);if(U){if(U===v)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(b==="suspendedStart")throw b="completed",l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);b="executing";var A=w(S,P,l);if(A.type==="normal"){if(b=l.done?"completed":"suspendedYield",A.arg===v)continue;return{value:A.arg,done:l.done}}A.type==="throw"&&(b="completed",l.method="throw",l.arg=A.arg)}}}(e,o,m),y}function w(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(s){return{type:"throw",arg:s}}}n.wrap=p;var v={};function k(){}function x(){}function g(){}var L={};f(L,i,function(){return this});var _=Object.getPrototypeOf,O=_&&_(_(R([])));O&&O!==u&&a.call(O,i)&&(L=O);var j=g.prototype=k.prototype=Object.create(L);function Y(e){["next","throw","return"].forEach(function(t){f(e,t,function(o){return this._invoke(t,o)})})}function T(e,t){function o(r,y,m,S){var P=w(e[r],e,y);if(P.type!=="throw"){var l=P.arg,b=l.value;return b&&F(b)=="object"&&a.call(b,"__await")?t.resolve(b.__await).then(function(E){o("next",E,m,S)},function(E){o("throw",E,m,S)}):t.resolve(b).then(function(E){l.value=E,m(l)},function(E){return o("throw",E,m,S)})}S(P.arg)}var s;this._invoke=function(r,y){function m(){return new t(function(S,P){o(r,y,S,P)})}return s=s?s.then(m,m):m()}}function D(e,t){var o=e.iterator[t.method];if(o===void 0){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=void 0,D(e,t),t.method==="throw"))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=w(o,e.iterator,t.arg);if(s.type==="throw")return t.method="throw",t.arg=s.arg,t.delegate=null,v;var r=s.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=void 0),t.delegate=null,v):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=void 0,r.done=!0,r};return s.next=s}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return x.prototype=g,f(j,"constructor",g),f(g,"constructor",x),x.displayName=f(g,h,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===x||(t.displayName||t.name)==="GeneratorFunction")},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,f(e,h,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},Y(T.prototype),f(T.prototype,d,function(){return this}),n.AsyncIterator=T,n.async=function(e,t,o,s,r){r===void 0&&(r=Promise);var y=new T(p(e,t,o,s),r);return n.isGeneratorFunction(t)?y:y.next().then(function(m){return m.done?m.value:y.next()})},Y(j),f(j,h,"Generator"),f(j,i,function(){return this}),f(j,"toString",function(){return"[object Generator]"}),n.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function s(){for(;t.length;){var r=t.pop();if(r in e)return s.value=r,s.done=!1,s}return s.done=!0,s}},n.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)t.charAt(0)==="t"&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(P,l){return y.type="throw",y.arg=e,t.next=P,l&&(t.method="next",t.arg=void 0),!!l}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],y=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var m=a.call(r,"catchLoc"),S=a.call(r,"finallyLoc");if(m&&S){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(m){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!S)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var y=r?r.completion:{};return y.type=e,y.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(y)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),N(o),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var s=o.completion;if(s.type==="throw"){var r=s.arg;N(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:R(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=void 0),v}},n}function B(n,u,a,c,i,d,h){try{var f=n[d](h),p=f.value}catch(w){return void a(w)}f.done?u(p):Promise.resolve(p).then(c,i)}function kt(n,u,a){return Object.defineProperty(n,"prototype",{writable:!1}),n}function J(n,u,a){return u in n?Object.defineProperty(n,u,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[u]=a,n}M.r(it),M.d(it,{AudioNodeVAD:()=>jt,AudioSegmentVAD:()=>qt,FrameProcessor:()=>ut,MicVAD:()=>Wt,arrayBufferToBase64:()=>Rt,audioFileToArray:()=>Ut,defaultVadOptions:()=>nt,encodeWAV:()=>It,minFramesForTargetMS:()=>$t});var at,Ft=function(n){var u=n.reduce(function(c,i){return c.push(c.at(-1)+i.length),c},[0]),a=new Float32Array(u.at(-1));return n.forEach(function(c,i){var d=u[i];a.set(c,d)}),a},ut=kt(function n(u,a,c){var i=this;(function(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")})(this,n),J(this,"speaking",!1),J(this,"redemptionCounter",0),J(this,"active",!1),J(this,"reset",function(){i.speaking=!1,i.audioBuffer=[],i.modelResetFunc(),i.redemptionCounter=0}),J(this,"pause",function(){i.active=!1,i.reset()}),J(this,"resume",function(){i.active=!0}),J(this,"process",function(){var d,h=(d=G().mark(function f(p){var w,v,k;return G().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(i.active){x.next=2;break}return x.abrupt("return");case 2:return x.next=4,i.modelProcessFunc(p);case 4:if(w=x.sent,i.options.onFrameProcessed(w),i.audioBuffer.push(p),w.isSpeech>=i.options.positiveSpeechThreshold&&i.redemptionCounter&&(i.redemptionCounter=0),w.isSpeech>=i.options.positiveSpeechThreshold&&!i.speaking&&(i.speaking=!0,i.options.signalSpeechStart()),w.isSpeech<i.options.negativeSpeechThreshold&&i.speaking&&++i.redemptionCounter>=i.options.redemptionFrames&&(i.redemptionCounter=0,i.speaking=!1,v=i.audioBuffer,i.audioBuffer=[],v.length>=i.options.minSpeechFrames?(k=Ft(v),i.options.signalSpeechEnd(k)):i.options.signalMisfire()),!i.speaking)for(;i.audioBuffer.length>i.options.preSpeechPadFrames;)i.audioBuffer.shift();case 11:case"end":return x.stop()}},f)}),function(){var f=this,p=arguments;return new Promise(function(w,v){var k=d.apply(f,p);function x(L){B(k,w,v,x,g,"next",L)}function g(L){B(k,w,v,x,g,"throw",L)}x(void 0)})});return function(f){return h.apply(this,arguments)}}()),this.modelProcessFunc=u,this.modelResetFunc=a,this.options=c,this.audioBuffer=[],this.reset()}),At="[VAD]",z=["error","debug","warn"].reduce(function(n,u){return n[u]=function(a){return function(){for(var c,i=arguments.length,d=new Array(i),h=0;h<i;h++)d[h]=arguments[h];(c=console)[a].apply(c,[At].concat(d))}}(u),n},{});(function(n){n[n.AudioFrame=0]="AudioFrame"})(at||(at={}));var Z=M(656);const Tt=M.p+"568bf886c02ac597add4.onnx";function ct(n){return ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},ct(n)}function wt(n,u){(u==null||u>n.length)&&(u=n.length);for(var a=0,c=new Array(u);a<u;a++)c[a]=n[a];return c}function K(){K=function(){return n};var n={},u=Object.prototype,a=u.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},i=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function f(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(t,o,s){return t[o]=s}}function p(e,t,o,s){var r=t&&t.prototype instanceof k?t:k,y=Object.create(r.prototype),m=new I(s||[]);return y._invoke=function(S,P,l){var b="suspendedStart";return function(E,W){if(b==="executing")throw new Error("Generator is already running");if(b==="completed"){if(E==="throw")throw W;return{value:void 0,done:!0}}for(l.method=E,l.arg=W;;){var q=l.delegate;if(q){var U=D(q,l);if(U){if(U===v)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(b==="suspendedStart")throw b="completed",l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);b="executing";var A=w(S,P,l);if(A.type==="normal"){if(b=l.done?"completed":"suspendedYield",A.arg===v)continue;return{value:A.arg,done:l.done}}A.type==="throw"&&(b="completed",l.method="throw",l.arg=A.arg)}}}(e,o,m),y}function w(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(s){return{type:"throw",arg:s}}}n.wrap=p;var v={};function k(){}function x(){}function g(){}var L={};f(L,i,function(){return this});var _=Object.getPrototypeOf,O=_&&_(_(R([])));O&&O!==u&&a.call(O,i)&&(L=O);var j=g.prototype=k.prototype=Object.create(L);function Y(e){["next","throw","return"].forEach(function(t){f(e,t,function(o){return this._invoke(t,o)})})}function T(e,t){function o(r,y,m,S){var P=w(e[r],e,y);if(P.type!=="throw"){var l=P.arg,b=l.value;return b&&ct(b)=="object"&&a.call(b,"__await")?t.resolve(b.__await).then(function(E){o("next",E,m,S)},function(E){o("throw",E,m,S)}):t.resolve(b).then(function(E){l.value=E,m(l)},function(E){return o("throw",E,m,S)})}S(P.arg)}var s;this._invoke=function(r,y){function m(){return new t(function(S,P){o(r,y,S,P)})}return s=s?s.then(m,m):m()}}function D(e,t){var o=e.iterator[t.method];if(o===void 0){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=void 0,D(e,t),t.method==="throw"))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=w(o,e.iterator,t.arg);if(s.type==="throw")return t.method="throw",t.arg=s.arg,t.delegate=null,v;var r=s.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=void 0),t.delegate=null,v):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=void 0,r.done=!0,r};return s.next=s}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return x.prototype=g,f(j,"constructor",g),f(g,"constructor",x),x.displayName=f(g,h,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===x||(t.displayName||t.name)==="GeneratorFunction")},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,f(e,h,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},Y(T.prototype),f(T.prototype,d,function(){return this}),n.AsyncIterator=T,n.async=function(e,t,o,s,r){r===void 0&&(r=Promise);var y=new T(p(e,t,o,s),r);return n.isGeneratorFunction(t)?y:y.next().then(function(m){return m.done?m.value:y.next()})},Y(j),f(j,h,"Generator"),f(j,i,function(){return this}),f(j,"toString",function(){return"[object Generator]"}),n.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function s(){for(;t.length;){var r=t.pop();if(r in e)return s.value=r,s.done=!1,s}return s.done=!0,s}},n.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)t.charAt(0)==="t"&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(P,l){return y.type="throw",y.arg=e,t.next=P,l&&(t.method="next",t.arg=void 0),!!l}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],y=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var m=a.call(r,"catchLoc"),S=a.call(r,"finallyLoc");if(m&&S){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(m){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!S)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var y=r?r.completion:{};return y.type=e,y.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(y)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),N(o),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var s=o.completion;if(s.type==="throw"){var r=s.arg;N(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:R(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=void 0),v}},n}function bt(n,u,a,c,i,d,h){try{var f=n[d](h),p=f.value}catch(w){return void a(w)}f.done?u(p):Promise.resolve(p).then(c,i)}function st(n){return function(){var u=this,a=arguments;return new Promise(function(c,i){var d=n.apply(u,a);function h(p){bt(d,c,i,h,f,"next",p)}function f(p){bt(d,c,i,h,f,"throw",p)}h(void 0)})}}function Nt(n,u,a){return Object.defineProperty(n,"prototype",{writable:!1}),n}function tt(n,u,a){return u in n?Object.defineProperty(n,u,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[u]=a,n}var et=Nt(function n(){var u=this;(function(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")})(this,n),tt(this,"init",st(K().mark(function a(){var c;return K().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return z.debug("initializing vad"),i.next=3,fetch(Tt).then(function(d){return d.arrayBuffer()});case 3:return c=i.sent,i.next=6,Z.InferenceSession.create(c);case 6:u._session=i.sent,u._sr=new Z.Tensor("int64",[16000n]),u.reset_state(),z.debug("vad is initialized");case 10:case"end":return i.stop()}},a)}))),tt(this,"reset_state",function(){var a=Array(128).fill(0);u._h=new Z.Tensor("float32",a,[2,1,64]),u._c=new Z.Tensor("float32",a,[2,1,64])}),tt(this,"process",function(){var a=st(K().mark(function c(i){var d,h,f,p,w,v,k;return K().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return d=new Z.Tensor("float32",i,[1,i.length]),h={input:d,h:u._h,c:u._c,sr:u._sr},x.next=4,u._session.run(h);case 4:return f=x.sent,u._h=f.hn,u._c=f.cn,p=f.output.data,L=1,w=function(_){if(Array.isArray(_))return _}(g=p)||function(_,O){var j=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(j!=null){var Y,T,D=[],$=!0,N=!1;try{for(j=j.call(_);!($=(Y=j.next()).done)&&(D.push(Y.value),!O||D.length!==O);$=!0);}catch(I){N=!0,T=I}finally{try{$||j.return==null||j.return()}finally{if(N)throw T}}return D}}(g,L)||function(_,O){if(_){if(typeof _=="string")return wt(_,O);var j=Object.prototype.toString.call(_).slice(8,-1);return j==="Object"&&_.constructor&&(j=_.constructor.name),j==="Map"||j==="Set"?Array.from(_):j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j)?wt(_,O):void 0}}(g,L)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}(),v=w[0],k=1-v,x.abrupt("return",{notSpeech:k,isSpeech:v});case 10:case"end":return x.stop()}var g,L},c)}));return function(c){return a.apply(this,arguments)}}())});function ft(n,u){(u==null||u>n.length)&&(u=n.length);for(var a=0,c=new Array(u);a<u;a++)c[a]=n[a];return c}function Gt(n,u,a){return Object.defineProperty(n,"prototype",{writable:!1}),n}tt(et,"new",st(K().mark(function n(){var u;return K().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return u=new et,a.next=3,u.init();case 3:return a.abrupt("return",u);case 4:case"end":return a.stop()}},n)})));var Ct=Gt(function n(u){var a,c,i=this;(function(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")})(this,n),c=function(d){var h,f,p=[];for((h=i.inputBuffer).push.apply(h,function(L){if(Array.isArray(L))return ft(L)}(f=d)||function(L){if(typeof Symbol<"u"&&L[Symbol.iterator]!=null||L["@@iterator"]!=null)return Array.from(L)}(f)||function(L,_){if(L){if(typeof L=="string")return ft(L,_);var O=Object.prototype.toString.call(L).slice(8,-1);return O==="Object"&&L.constructor&&(O=L.constructor.name),O==="Map"||O==="Set"?Array.from(L):O==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O)?ft(L,_):void 0}}(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());i.inputBuffer.length*i.options.targetSampleRate/i.options.nativeSampleRate>i.options.targetFrameSize;){for(var w=new Float32Array(i.options.targetFrameSize),v=0,k=0;v<i.options.targetFrameSize;){for(var x=0,g=0;k<Math.min(i.inputBuffer.length,(v+1)*i.options.nativeSampleRate/i.options.targetSampleRate);)x+=i.inputBuffer[k],g++,k++;w[v]=x/g,v++}i.inputBuffer=i.inputBuffer.slice(k),p.push(w)}return p},(a="process")in this?Object.defineProperty(this,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):this[a]=c,this.options=u,this.inputBuffer=[]});function It(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:16e3,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:32,d=i/8,h=c*d,f=new ArrayBuffer(44+n.length*d),p=new DataView(f);return rt(p,0,"RIFF"),p.setUint32(4,36+n.length*d,!0),rt(p,8,"WAVE"),rt(p,12,"fmt "),p.setUint32(16,16,!0),p.setUint16(20,u,!0),p.setUint16(22,c,!0),p.setUint32(24,a,!0),p.setUint32(28,a*h,!0),p.setUint16(32,h,!0),p.setUint16(34,i,!0),rt(p,36,"data"),p.setUint32(40,n.length*d,!0),u===1?Bt(p,44,n):Mt(p,44,n),f}function Mt(n,u,a){for(var c=0;c<a.length;c++,u+=4)n.setFloat32(u,a[c],!0)}function Bt(n,u,a){for(var c=0;c<a.length;c++,u+=2){var i=Math.max(-1,Math.min(1,a[c]));n.setInt16(u,i<0?32768*i:32767*i,!0)}}function rt(n,u,a){for(var c=0;c<a.length;c++)n.setUint8(u+c,a.charCodeAt(c))}function lt(n){return lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},lt(n)}function ht(){ht=function(){return n};var n={},u=Object.prototype,a=u.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},i=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function f(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(t,o,s){return t[o]=s}}function p(e,t,o,s){var r=t&&t.prototype instanceof k?t:k,y=Object.create(r.prototype),m=new I(s||[]);return y._invoke=function(S,P,l){var b="suspendedStart";return function(E,W){if(b==="executing")throw new Error("Generator is already running");if(b==="completed"){if(E==="throw")throw W;return{value:void 0,done:!0}}for(l.method=E,l.arg=W;;){var q=l.delegate;if(q){var U=D(q,l);if(U){if(U===v)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(b==="suspendedStart")throw b="completed",l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);b="executing";var A=w(S,P,l);if(A.type==="normal"){if(b=l.done?"completed":"suspendedYield",A.arg===v)continue;return{value:A.arg,done:l.done}}A.type==="throw"&&(b="completed",l.method="throw",l.arg=A.arg)}}}(e,o,m),y}function w(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(s){return{type:"throw",arg:s}}}n.wrap=p;var v={};function k(){}function x(){}function g(){}var L={};f(L,i,function(){return this});var _=Object.getPrototypeOf,O=_&&_(_(R([])));O&&O!==u&&a.call(O,i)&&(L=O);var j=g.prototype=k.prototype=Object.create(L);function Y(e){["next","throw","return"].forEach(function(t){f(e,t,function(o){return this._invoke(t,o)})})}function T(e,t){function o(r,y,m,S){var P=w(e[r],e,y);if(P.type!=="throw"){var l=P.arg,b=l.value;return b&&lt(b)=="object"&&a.call(b,"__await")?t.resolve(b.__await).then(function(E){o("next",E,m,S)},function(E){o("throw",E,m,S)}):t.resolve(b).then(function(E){l.value=E,m(l)},function(E){return o("throw",E,m,S)})}S(P.arg)}var s;this._invoke=function(r,y){function m(){return new t(function(S,P){o(r,y,S,P)})}return s=s?s.then(m,m):m()}}function D(e,t){var o=e.iterator[t.method];if(o===void 0){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=void 0,D(e,t),t.method==="throw"))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=w(o,e.iterator,t.arg);if(s.type==="throw")return t.method="throw",t.arg=s.arg,t.delegate=null,v;var r=s.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=void 0),t.delegate=null,v):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=void 0,r.done=!0,r};return s.next=s}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return x.prototype=g,f(j,"constructor",g),f(g,"constructor",x),x.displayName=f(g,h,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===x||(t.displayName||t.name)==="GeneratorFunction")},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,f(e,h,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},Y(T.prototype),f(T.prototype,d,function(){return this}),n.AsyncIterator=T,n.async=function(e,t,o,s,r){r===void 0&&(r=Promise);var y=new T(p(e,t,o,s),r);return n.isGeneratorFunction(t)?y:y.next().then(function(m){return m.done?m.value:y.next()})},Y(j),f(j,h,"Generator"),f(j,i,function(){return this}),f(j,"toString",function(){return"[object Generator]"}),n.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function s(){for(;t.length;){var r=t.pop();if(r in e)return s.value=r,s.done=!1,s}return s.done=!0,s}},n.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)t.charAt(0)==="t"&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(P,l){return y.type="throw",y.arg=e,t.next=P,l&&(t.method="next",t.arg=void 0),!!l}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],y=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var m=a.call(r,"catchLoc"),S=a.call(r,"finallyLoc");if(m&&S){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(m){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!S)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var y=r?r.completion:{};return y.type=e,y.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(y)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),N(o),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var s=o.completion;if(s.type==="throw"){var r=s.arg;N(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:R(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=void 0),v}},n}function xt(n,u,a,c,i,d,h){try{var f=n[d](h),p=f.value}catch(w){return void a(w)}f.done?u(p):Promise.resolve(p).then(c,i)}function Dt(n){return function(){var u=this,a=arguments;return new Promise(function(c,i){var d=n.apply(u,a);function h(p){xt(d,c,i,h,f,"next",p)}function f(p){xt(d,c,i,h,f,"throw",p)}h(void 0)})}}function Rt(n){for(var u="",a=new Uint8Array(n),c=a.byteLength,i=0;i<c;i++)u+=String.fromCharCode(a[i]);return btoa(u)}function Ut(n){return St.apply(this,arguments)}function St(){return(St=Dt(ht().mark(function n(u){var a,c,i,d,h,f,p;return ht().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return a=new OfflineAudioContext(1,1,44100),c=new FileReader,i=null,w.next=5,new Promise(function(v){c.addEventListener("loadend",function(k){var x=c.result;a.decodeAudioData(x,function(g){i=g,a.startRendering().then(function(L){console.log("Rendering completed successfully"),v()}).catch(function(L){console.error("Rendering failed: ".concat(L))})},function(g){console.log("Error with decoding audio data: ".concat(g))})}),c.readAsArrayBuffer(u)});case 5:if(i!==null){w.next=7;break}throw Error("some shit");case 7:for(d=i,h=new Float32Array(d.length),f=0;f<d.length;f++)for(p=0;p<d.numberOfChannels;p++)h[f]+=d.getChannelData(p)[f];return w.abrupt("return",{audio:h,sampleRate:d.sampleRate});case 11:case"end":return w.stop()}},n)}))).apply(this,arguments)}function pt(n){return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},pt(n)}function Vt(n,u){var a=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=function(p,w){if(p){if(typeof p=="string")return Lt(p,w);var v=Object.prototype.toString.call(p).slice(8,-1);return v==="Object"&&p.constructor&&(v=p.constructor.name),v==="Map"||v==="Set"?Array.from(p):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?Lt(p,w):void 0}}(n))||u){a&&(n=a);var c=0,i=function(){};return{s:i,n:function(){return c>=n.length?{done:!0}:{done:!1,value:n[c++]}},e:function(p){throw p},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d,h=!0,f=!1;return{s:function(){a=a.call(n)},n:function(){var p=a.next();return h=p.done,p},e:function(p){f=!0,d=p},f:function(){try{h||a.return==null||a.return()}finally{if(f)throw d}}}}function Lt(n,u){(u==null||u>n.length)&&(u=n.length);for(var a=0,c=new Array(u);a<u;a++)c[a]=n[a];return c}function Et(n,u){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);u&&(c=c.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),a.push.apply(a,c)}return a}function X(n){for(var u=1;u<arguments.length;u++){var a=arguments[u]!=null?arguments[u]:{};u%2?Et(Object(a),!0).forEach(function(c){V(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Et(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function C(){C=function(){return n};var n={},u=Object.prototype,a=u.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},i=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function f(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch{f=function(t,o,s){return t[o]=s}}function p(e,t,o,s){var r=t&&t.prototype instanceof k?t:k,y=Object.create(r.prototype),m=new I(s||[]);return y._invoke=function(S,P,l){var b="suspendedStart";return function(E,W){if(b==="executing")throw new Error("Generator is already running");if(b==="completed"){if(E==="throw")throw W;return{value:void 0,done:!0}}for(l.method=E,l.arg=W;;){var q=l.delegate;if(q){var U=D(q,l);if(U){if(U===v)continue;return U}}if(l.method==="next")l.sent=l._sent=l.arg;else if(l.method==="throw"){if(b==="suspendedStart")throw b="completed",l.arg;l.dispatchException(l.arg)}else l.method==="return"&&l.abrupt("return",l.arg);b="executing";var A=w(S,P,l);if(A.type==="normal"){if(b=l.done?"completed":"suspendedYield",A.arg===v)continue;return{value:A.arg,done:l.done}}A.type==="throw"&&(b="completed",l.method="throw",l.arg=A.arg)}}}(e,o,m),y}function w(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(s){return{type:"throw",arg:s}}}n.wrap=p;var v={};function k(){}function x(){}function g(){}var L={};f(L,i,function(){return this});var _=Object.getPrototypeOf,O=_&&_(_(R([])));O&&O!==u&&a.call(O,i)&&(L=O);var j=g.prototype=k.prototype=Object.create(L);function Y(e){["next","throw","return"].forEach(function(t){f(e,t,function(o){return this._invoke(t,o)})})}function T(e,t){function o(r,y,m,S){var P=w(e[r],e,y);if(P.type!=="throw"){var l=P.arg,b=l.value;return b&&pt(b)=="object"&&a.call(b,"__await")?t.resolve(b.__await).then(function(E){o("next",E,m,S)},function(E){o("throw",E,m,S)}):t.resolve(b).then(function(E){l.value=E,m(l)},function(E){return o("throw",E,m,S)})}S(P.arg)}var s;this._invoke=function(r,y){function m(){return new t(function(S,P){o(r,y,S,P)})}return s=s?s.then(m,m):m()}}function D(e,t){var o=e.iterator[t.method];if(o===void 0){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=void 0,D(e,t),t.method==="throw"))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=w(o,e.iterator,t.arg);if(s.type==="throw")return t.method="throw",t.arg=s.arg,t.delegate=null,v;var r=s.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=void 0),t.delegate=null,v):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=void 0,r.done=!0,r};return s.next=s}}return{next:Q}}function Q(){return{value:void 0,done:!0}}return x.prototype=g,f(j,"constructor",g),f(g,"constructor",x),x.displayName=f(g,h,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===x||(t.displayName||t.name)==="GeneratorFunction")},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,f(e,h,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},Y(T.prototype),f(T.prototype,d,function(){return this}),n.AsyncIterator=T,n.async=function(e,t,o,s,r){r===void 0&&(r=Promise);var y=new T(p(e,t,o,s),r);return n.isGeneratorFunction(t)?y:y.next().then(function(m){return m.done?m.value:y.next()})},Y(j),f(j,h,"Generator"),f(j,i,function(){return this}),f(j,"toString",function(){return"[object Generator]"}),n.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function s(){for(;t.length;){var r=t.pop();if(r in e)return s.value=r,s.done=!1,s}return s.done=!0,s}},n.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)t.charAt(0)==="t"&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(P,l){return y.type="throw",y.arg=e,t.next=P,l&&(t.method="next",t.arg=void 0),!!l}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],y=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var m=a.call(r,"catchLoc"),S=a.call(r,"finallyLoc");if(m&&S){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(m){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!S)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var y=r?r.completion:{};return y.type=e,y.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(y)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),N(o),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var s=o.completion;if(s.type==="throw"){var r=s.arg;N(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:R(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=void 0),v}},n}function Ot(n,u,a,c,i,d,h){try{var f=n[d](h),p=f.value}catch(w){return void a(w)}f.done?u(p):Promise.resolve(p).then(c,i)}function H(n){return function(){var u=this,a=arguments;return new Promise(function(c,i){var d=n.apply(u,a);function h(p){Ot(d,c,i,h,f,"next",p)}function f(p){Ot(d,c,i,h,f,"throw",p)}h(void 0)})}}function dt(n,u){if(!(n instanceof u))throw new TypeError("Cannot call a class as a function")}function Yt(n,u){for(var a=0;a<u.length;a++){var c=u[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(n,c.key,c)}}function vt(n,u,a){return a&&Yt(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}function V(n,u,a){return u in n?Object.defineProperty(n,u,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[u]=a,n}z.debug("WELCOME TO VAD");var zt=[512,1024,1536];function $t(n,u){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:16e3;return Math.ceil(n*a/1e3/u)}var nt={onSpeechStart:function(){z.debug("Detected speech start")},onSpeechEnd:function(){z.debug("Detected speech end")},onFrameProcessed:function(){},signalMisfire:function(){},positiveSpeechThreshold:.5,negativeSpeechThreshold:.35,preSpeechPadFrames:1,redemptionFrames:2,frameSamples:1536,minSpeechFrames:3};function yt(n){zt.includes(n.frameSamples)||z.warn("You are using an unusual frame size"),(n.positiveSpeechThreshold<0||n.negativeSpeechThreshold>1)&&z.error("postiveSpeechThreshold should be a number between 0 and 1"),(n.negativeSpeechThreshold<0||n.negativeSpeechThreshold>n.positiveSpeechThreshold)&&z.error("negativeSpeechThreshold should be between 0 and postiveSpeechThreshold"),n.preSpeechPadFrames<0&&z.error("preSpeechPadFrames should be positive"),n.redemptionFrames<0&&z.error("preSpeechPadFrames should be positive")}var Wt=function(){function n(a){var c=this;dt(this,n),V(this,"listening",!1),V(this,"init",H(C().mark(function i(){var d;return C().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,navigator.mediaDevices.getUserMedia({audio:{channelCount:1,echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0}});case 2:return c.stream=h.sent,c.audioContext=new AudioContext,d=new MediaStreamAudioSourceNode(c.audioContext,{mediaStream:c.stream}),h.next=7,jt.new(c.audioContext,c.options);case 7:c.audioNodeVAD=h.sent,c.audioNodeVAD.receive(d);case 9:case"end":return h.stop()}},i)}))),V(this,"pause",function(){c.listening=!1,c.audioNodeVAD.pause()}),V(this,"start",function(){c.listening=!0,c.audioNodeVAD.start()}),this.options=a,yt(a)}var u;return vt(n,null,[{key:"new",value:(u=H(C().mark(function a(){var c,i,d=arguments;return C().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=d.length>0&&d[0]!==void 0?d[0]:{},i=new n(X(X({},nt),c)),h.next=4,i.init();case 4:return h.abrupt("return",i);case 5:case"end":return h.stop()}},a)})),function(){return u.apply(this,arguments)})}]),n}(),qt=function(){function n(a){var c=this;dt(this,n),V(this,"speaking",!1),V(this,"init",H(C().mark(function i(){var d;return C().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,et.new();case 2:d=h.sent,c.frameProcessor=new ut(d.process,d.reset_state,{onFrameProcessed:c.options.onFrameProcessed,signalSpeechStart:function(){c.speaking=!0,c.options.onSpeechStart()},signalSpeechEnd:function(f){c.speaking=!1,c.options.onSpeechEnd(f)},signalMisfire:c.options.signalMisfire,positiveSpeechThreshold:c.options.positiveSpeechThreshold,negativeSpeechThreshold:c.options.negativeSpeechThreshold,redemptionFrames:c.options.redemptionFrames,preSpeechPadFrames:c.options.preSpeechPadFrames,minSpeechFrames:c.options.minSpeechFrames}),c.frameProcessor.resume();case 5:case"end":return h.stop()}},i)}))),V(this,"run",function(){var i=H(C().mark(function d(h,f){var p,w,v,k,x;return C().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:p=new Ct({nativeSampleRate:f,targetSampleRate:16e3,targetFrameSize:c.options.frameSamples}),w=p.process(h),v=Vt(w),g.prev=3,v.s();case 5:if((k=v.n()).done){g.next=11;break}return x=k.value,g.next=9,c.frameProcessor.process(x);case 9:g.next=5;break;case 11:g.next=16;break;case 13:g.prev=13,g.t0=g.catch(3),v.e(g.t0);case 16:return g.prev=16,v.f(),g.finish(16);case 19:case"end":return g.stop()}},d,null,[[3,13,16,19]])}));return function(d,h){return i.apply(this,arguments)}}()),this.options=a,yt(a)}var u;return vt(n,null,[{key:"new",value:(u=H(C().mark(function a(){var c,i,d=arguments;return C().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=d.length>0&&d[0]!==void 0?d[0]:{},i=new n(X(X({},nt),c)),h.next=4,i.init();case 4:return h.abrupt("return",i);case 5:case"end":return h.stop()}},a)})),function(){return u.apply(this,arguments)})}]),n}(),jt=function(){function n(a,c){var i=this;dt(this,n),V(this,"listening",!1),V(this,"speaking",!1),V(this,"pause",function(){z.debug("pausing vad"),i.frameProcessor.pause(),i.listening=!1}),V(this,"start",function(){z.debug("starting vad"),i.frameProcessor.resume(),i.listening=!0}),V(this,"receive",function(d){d.connect(i.entryNode)}),V(this,"init",H(C().mark(function d(){var h,f,p;return C().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return h=M.p+"vad.worklet.js",w.next=3,i.ctx.audioWorklet.addModule(h);case 3:return f=new AudioWorkletNode(i.ctx,"vad-helper-worklet",{processorOptions:{frameSamples:i.options.frameSamples}}),i.entryNode=f,w.next=7,et.new();case 7:p=w.sent,i.frameProcessor=new ut(p.process,p.reset_state,{onFrameProcessed:i.options.onFrameProcessed,signalSpeechStart:function(){i.speaking=!0,i.options.onSpeechStart()},signalSpeechEnd:function(v){i.speaking=!1,i.options.onSpeechEnd(v)},signalMisfire:i.options.signalMisfire,positiveSpeechThreshold:i.options.positiveSpeechThreshold,negativeSpeechThreshold:i.options.negativeSpeechThreshold,redemptionFrames:i.options.redemptionFrames,preSpeechPadFrames:i.options.preSpeechPadFrames,minSpeechFrames:i.options.minSpeechFrames}),f.port.onmessage=function(){var v=H(C().mark(function k(x){var g,L,_;return C().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:O.t0=(g=x.data)===null||g===void 0?void 0:g.message,O.next=O.t0===at.AudioFrame?3:8;break;case 3:return L=x.data.data,_=new Float32Array(L),O.next=7,i.frameProcessor.process(_);case 7:case 8:return O.abrupt("break",9);case 9:case"end":return O.stop()}},k)}));return function(k){return v.apply(this,arguments)}}();case 10:case"end":return w.stop()}},d)}))),this.ctx=a,this.options=c,yt(c)}var u;return vt(n,null,[{key:"new",value:(u=H(C().mark(function a(c){var i,d,h=arguments;return C().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i=h.length>1&&h[1]!==void 0?h[1]:{},d=new n(c,X(X({},nt),i)),f.next=4,d.init();case 4:return f.abrupt("return",d);case 5:case"end":return f.stop()}},a)})),function(a){return u.apply(this,arguments)})}]),n}()})(),it})())})(Pt);var Qt=Pt.exports;export{Qt as d};
